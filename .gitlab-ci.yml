variables:
  GIT_SUBMODULE_STRATEGY: recursive

image: ruby:alpine
before_script:
  - ruby -v
  - apk update
  - apk add bash build-base bison git curl valgrind gcovr
  - which ruby

test:
  variables:
    RED_TEXT: "\e[10m"
    GREEN_TEXT: "\e[32m"
    LRED_TEXT: "\e[91m"
    NORMAL_TEXT: "\e[0m"
  tags:
    - cpp
  script:
    - LEAKCHECK=1 make
    - make coverage
    - cat gcov.log
  coverage: '/^Lines executed *: *(\d+\.\d+%) of/'
